<!DOCTYPE html>
<!-- saved from url=(0050)https://getbootstrap.com/docs/4.0/examples/cover/# -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="https://getbootstrap.com/favicon.ico">

    <title>Taman Kota Bandung</title>

    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/cover.css" rel="stylesheet">
	<link href="./css/style.css" rel="stylesheet">
	
  </head>

  <body>    
    
    
    <div class="site-wrapper">
      <div class="site-wrapper-inner">

        <div class="cover-container">

          <header class="masthead clearfix">
            <div class="inner">
              <h3 class="masthead-brand">Taman Kota Bandung</h3>              
            </div>
          </header>

          <main role="main" class="inner cover">
            <br>
            <h1 class="cover-heading" id="coverhead1">Selamat datang</h1>
            <p class="lead" id="coverpar1">Silahkan gunakan search box untuk mencari taman yang ingin dicari</p>
            <p class="lead">
              <input type="text" class ="textinput" id="input1" ><br>
              <br>
              <div class="row"><div class="col-6">
                  <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalLong1" id="button1">
                    Cari Taman
                  </button>
            </div><div class="col-6">
                  <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalLong2" id="button2">
                    Tampilkan list taman
                  </button>
            </div></div>

              <!-- Modal -->
              <div class="modal fade" id="exampleModalLong1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLongTitle">Taman X</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body anoa">
                      <div class="taman">
                        <img id="tamanImg" alt="a">
                        <h3 id="tamanHeader">Taman X</h3>   
                        <p id="tamanKeterangan">Alamat : x<br>Jam Buka : 24 Jam</p>
                        <p id="tamanDeskripsi">Taman ini berada di dekat ini, untuk mengakses taman ini anda perlu parkir di dekat jalan ini, jika anda parkir menggunakan mobil bisa parkir dulu di ini</p>
                        <h3>Peta</h3>
                      </div>
                      <div id="map"></div>
                    </div>
                    <div class="modal-footer">
                      <button type="button" id="directButton" class="btn btn-success" data-dismiss="modal" onclick="location.href = '#';">Go To Place!</button>
                      <button type="button" class="btn btn-primary" data-dismiss="modal">close</button>
                    </div>
                    
                  </div>
                </div>
              </div>
              <!-- Modal -->
              <div class="modal fade" id="exampleModalLong2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLongTitle">List Taman</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body" id="modal2">
                      
                    </div>
                    <div class="modal-footer">
                        
                      <button type="button" class="btn btn-primary" data-dismiss="modal">close</button>
                      
                    </div>
                  </div>
                </div>
              </div>
            </p>
          </main>

          <footer class="mastfoot">
            <div class="inner">
              
            </div>
          </footer>

        </div>

      </div>

    </div>
    
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="./js/jquery-3.2.1.min.js"></script>
    
    <script>window.jQuery || document.write('<script src="../../../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="./js/popper.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script>
    var currLat = 0;
    var currLng = 0;
    function getLocation() {
      if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
      } else { 
          x.innerHTML = "Geolocation is not supported by this browser.";
      }        
    }
    function showPosition(position) {
      currLat = position.coords.latitude;
      currLng = position.coords.longitude;
    }
    </script>
    <script>
      $(document).ready(function() {
        getLocation();
        $('.carousel').carousel();
        $('#input1').keypress(function(e){
          if(e.keyCode==13)
          $('#button1').click();
        });
        $("#button1").on("click", function(){
          
              // Only change code below this line.
          $.getJSON("./json/taman.json", function(json) {                                       
            var html = "";
            var query = $('#input1').val();
            var r = new RegExp(query, "i");
            var judul = '#exampleModalLongTitle';
            var BreakException = {};
            var found = false;
            var myLatLong = {lat:0,lng:0};
          // Only change code below this line.
    
            json.forEach(function(val) {
              var keys = Object.keys(val);
              var valJudul = val['name']; 
              var res = valJudul.match(r);
              if ((!found)&&(res!==null)&&((query !== "Taman")&&(query !== "taman"))&&(query.length != 0)) {
                found = true;
                $('#tamanImg').attr('src',val['imageLink']);
                $('#tamanImg').attr('alt',val['altText']);
                $(judul).html(valJudul);              
                $('#tamanHeader').html(valJudul);              
                var keterangan = "Alamat : " + val['address'] + "<br>Jam Buka : " + val['workHour'];
                $('#tamanKeterangan').html(keterangan);
                $('#tamanDeskripsi').html(val['desc']);
                myLatLong = {lat: val['lat'], lng: val['lon']};
                map = new google.maps.Map(document.getElementById('map'), {
                  zoom: 18,
                  center: myLatLong
                });
                marker = new google.maps.Marker({
                  map: map,
                  position: myLatLong,
                  title: 'Hello World!'
                });
                myLatLolong = myLatLong;
                myLatLolong.lat+=0.001;
                myLatLolong.lng-=0.0014;
                map.setCenter(myLatLolong);
                google.maps.event.addListenerOnce(map, 'idle', function() {
                  google.maps.event.trigger(map, 'resize');
                });
                map.setCenter(myLatLolong);
                var directLink = "";
                directLink = "window.open('https://www.google.com/maps/dir/?api=1&origin=" + currLat + "," + currLng + "&destination=" + val["searchQuery"]+"', '_blank');";

                console.log(myLatLong["lat"],myLatLong["lng"])
                $("#directButton").attr("onclick",directLink); 
              } else {
                if (!found) {
                  $(judul).html('Taman Tidak Ditemukan');              
                  $('#tamanHeader').html('Taman yang anda cari tidak ada');     
                  $('#tamanImg').attr('src','./img/notfound.png');         
                  $('#tamanImg').attr('alt','Tidak Ada');
                  $('#tamanKeterangan').html('');
                  $('#tamanDeskripsi').html('');
                }

              }           
            });          
          // Only change code above this line.            
                    
          });
        });      
        $("#button2").on("click", function(){
          var html="";
          var myLatLong = {lat:0,lng:0};
          $.getJSON("./json/taman.json", function(json) {
            json.forEach(function(val) {
              myLatLong = {lat: val['lat'], lng: val['lon']};
              var directLink = "window.open('https://www.google.com/maps/dir/?api=1&origin=" + currLat + "," + currLng + "&destination=" + val["searchQuery"]+"', '_blank');";
              var keys = Object.keys(val);
              html+='<div class="row" style="padding: 5px 0 5px 0;margin-bottom:10px;border-bottom:1px solid #e9ecef;"><div class="col-3"><img src="'+ val['imageLink'] +'" alt="'+val['altText']+'"></div><div class="col-6" style="text-align: left;"><h6>'+val['name']+'</h6><p style="font-size:0.8em;">'+val['address']+'</p><h7>'+ val['workHour'] +'</h7></div><div class="col-3"><button class="btn btn-success" onclick="'+directLink+'">Go!</button></div></div>';              
            });
            $('#modal2').html(html);
          });             
          
        });  
      });
    </script>
    <script>
    function initMap() {
      var myLatLng = {lat: -25.363, lng: 131.044};

      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 4,
        center: myLatLng
      });

      var marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        title: 'Hello World!'
      });
    }
    
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAY27kn9izD2u0en0K0SRsX1S32LWMC2_4&callback=initMap">
    </script>
</body></html>