<!DOCTYPE html>
<!-- saved from url=(0050)https://getbootstrap.com/docs/4.0/examples/cover/# -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="./img/favicon.ico">

    <title>Taman Kota Bandung</title>

    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/cover.css" rel="stylesheet">
    <link href="./css/style.css" rel="stylesheet">
    <link href="./css/font-awesome.css" rel="stylesheet">
	
  </head>

  <body>    
    
    
    <div class="site-wrapper">
      <div class="site-wrapper-inner">

        <div class="cover-container">

          <header class="masthead clearfix">
            <div class="inner">
              <h3 class="masthead-brand"></h3>              
            </div>
          </header>

          <main role="main" class="inner cover">
            <div class="test">
            <img src="./img/logo.png" width="60%" />
            <br>
            <h1 class="cover-heading" id="coverhead1">Wilujeng Sumping</h1>
            <p class="lead" id="coverpar1">Silahkan gunakan search box untuk mencari taman yang ingin dicari</p>
            <p class="lead">
              <input type="text" class ="textinput" id="input1" placeholder="tulis nama taman yang akan dicari"><br>
              <br>
              <div class="row">
                  <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalLong1" id="button1">
                    Cari Taman
                  </button>
            <br>
          </div>
          </p>
          <p id="p1">atau lihat <a href="#exampleModalLong2" data-toggle="modal" data-target="#exampleModalLong2" id="link2">Daftar Taman</a> dan <a href="#exampleModalLong1" data-toggle="modal" data-target="#exampleModalLong1" id="link5">Taman Terdekat</a></p>
          <br>
          
        </div>
              <!-- Modal -->
              <div class="modal fade" id="exampleModalLong1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLongTitle1">Taman X</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body anoa">
                      <div class="taman">
                        <img id="tamanImg" alt="a">
                        <h3 id="tamanHeader">Taman X</h3>   
                        <p id="tamanKeterangan">Alamat : x<br>Jam Buka : 24 Jam</p>
                        <p id="tamanDeskripsi">Taman ini berada di dekat ini, untuk mengakses taman ini anda perlu parkir di dekat jalan ini, jika anda parkir menggunakan mobil bisa parkir dulu di ini</p>
                        <h3 id="mapHeader">Peta</h3>
                      </div>
                      <div id="map"></div>
                    </div>
                    <div class="modal-footer">
                      <button type="button" id="directButton" class="btn btn-success" data-dismiss="modal" onclick="location.href = '#';">Go To Place!</button>
                      <button type="button" class="btn btn-primary" data-dismiss="modal">close</button>
                    </div>
                    
                  </div>
                </div>
              </div>
              <!-- Modal -->
              <div class="modal fade" id="exampleModalLong2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLongTitle2">Daftar Taman</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body" id="modal2">
                      
                    </div>
                    <div class="modal-footer">
                        
                      <button type="button" class="btn btn-primary" data-dismiss="modal">close</button>
                      
                    </div>
                  </div>
                </div>
              </div>
              <!-- Modal -->
              <div class="modal fade" id="exampleModalLong3" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLongTitle3">About</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body" id="modal2">
                      <h6>Taman Kota Bandung</h6>
                      <p>Website ini berfungsi sebagai penunjuk arah pengguna mencari taman yang ada di kota bandung.</p>
                      <p>Website ini juga tersedia dalam bentuk mobile apps.</p>

                      <p>Developer:</p>
                      <span class="fa fa-play">  Mahdiar Naufal</span>
                      <br>
                      <span class="fa fa-play">  Tessa Angela</span>

                    </div>
                    <div class="modal-footer">
                        
                      <button type="button" class="btn btn-primary" data-dismiss="modal">close</button>
                      
                    </div>
                  </div>
                </div>
              </div>
              <!-- Modal -->
              <div class="modal fade" id="exampleModalLong4" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLongTitle4">Tambah Taman</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body" id="modal2">
                        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSeIn5CC2eZB6Irsm4XFydTLXaE55_Djh3cb2Rsne_fQuBTCSQ/viewform?embedded=true" width="100%" height="500" frameborder="0" marginheight="0" marginwidth="0">Memuat...</iframe>                    </div>
                    <div class="modal-footer">
                        
                      <button type="button" class="btn btn-primary" data-dismiss="modal">close</button>
                      
                    </div>
                  </div>
                </div>
              </div>
            </p>
          </main>

          <footer class="mastfoot">
            <div class="inner">
              <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalLong4" id="button4">
                <span class="fa fa-plus"></span> Tambah Taman
              </button>
              <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalLong3" id="button3">
                <span class="fa fa-info-circle"></span> About
              </button>
              
            </div>
          </footer>

        </div>

      </div>

    </div>
    
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="./js/jquery-3.2.1.min.js"></script>
    
    <script>window.jQuery || document.write('<script src="../../../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="./js/popper.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script>
    var currLat = 0;
    var currLng = 0;
    function getLocation() {
      if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
      } else { 
          x.innerHTML = "Geolocation is not supported by this browser.";
      }        
    }
    function showPosition(position) {
      currLat = position.coords.latitude;
      currLng = position.coords.longitude;
    }
    </script>
    <script>
      $(document).ready(function() {
        kamus = FuzzySet();
        $.getJSON("./json/taman.json",function(json) {
          json.forEach(function (val) {
            var valJudul = val['name'];
            kamus.add(valJudul);
          });
        });
        getLocation();
        $('.carousel').carousel();
        $('#input1').keypress(function(e){
          if(e.keyCode==13)
          $('#button1').click();
        });
        $("#button1").on("click", function(){
          
        
          $.getJSON("./json/taman.json", function(json) {                                       
            var html = "";
            var input = $('#input1').val();
            var fuzzyResult = kamus.get(input);
            var query = ""
            if (fuzzyResult === null) {
              query = "###"
            } else {
              query = fuzzyResult[0][1];
            }
            
            var r = new RegExp(query, "i");
            var judul = '#exampleModalLongTitle1';
            var BreakException = {};
            var found = false;
            var myLatLong = {lat:0,lng:0};

            json.forEach(function(val) {
              var keys = Object.keys(val);
              var valJudul = val['name']; 
              var res = valJudul.match(r);
              if ((!found)&&(res!==null)&&((query !== "Taman")&&(query !== "taman"))&&(query.length != 0)) {
                found = true;
                $('#map').show();
                $('#mapHeader').show();
                $('#directButton').show();
                $('#tamanImg').attr('src',val['imageLink']);
                $('#tamanImg').attr('alt',val['altText']);
                $(judul).html(valJudul);              
                $('#tamanHeader').html(valJudul);              
                var keterangan = "Alamat : " + val['address'] + "<br>Jam Buka : " + val['workHour'];
                $('#tamanKeterangan').html(keterangan);
                $('#tamanDeskripsi').html(val['desc']);
                myLatLong = {lat: val['lat'], lng: val['lon']};
                map = new google.maps.Map(document.getElementById('map'), {
                  zoom: 18,
                  center: myLatLong
                });
                marker = new google.maps.Marker({
                  map: map,
                  position: myLatLong,
                  title: 'Hello World!'
                });
                myLatLolong = myLatLong;
                myLatLolong.lat+=0.001;
                myLatLolong.lng-=0.0014;
                map.setCenter(myLatLolong);
                google.maps.event.addListenerOnce(map, 'idle', function() {
                  google.maps.event.trigger(map, 'resize');
                });
                map.setCenter(myLatLolong);
                var directLink = "";
                directLink = "window.open('https://www.google.com/maps/dir/?api=1&origin=" + currLat + "," + currLng + "&destination=" + val["searchQuery"]+"', '_blank');";

                console.log(myLatLong["lat"],myLatLong["lng"])
                $("#directButton").attr("onclick",directLink); 
              } else {
                if (!found) {
                  $(judul).html('Taman Tidak Ditemukan');              
                  $('#tamanHeader').html('Taman yang anda cari tidak ada');     
                  $('#tamanImg').attr('src','./img/notfound.png');         
                  $('#tamanImg').attr('alt','Tidak Ada');
                  $('#tamanKeterangan').html('');
                  $('#tamanDeskripsi').html('');
                  $('#map').hide();
                  $('#mapHeader').hide();
                  $('#directButton').hide();
                }
              }           
            });             
          });
        });      
        $("#link2").on("click", function(){
          var html="";
          var myLatLong = {lat:0,lng:0};
          $.getJSON("./json/taman.json", function(json) {
            json.forEach(function(val) {
              myLatLong = {lat: val['lat'], lng: val['lon']};
              var directLink = "window.open('https://www.google.com/maps/dir/?api=1&origin=" + currLat + "," + currLng + "&destination=" + val["searchQuery"]+"', '_blank');";
              var keys = Object.keys(val);
              html+='<div class="row" style="padding: 5px 0 5px 0;margin-bottom:10px;border-bottom:1px solid #e9ecef;"><div class="col-3"><img src="'+ val['imageLink'] +'" alt="'+val['altText']+'"></div><div class="col-6" style="text-align: left;"><h6>'+val['name']+'</h6><p style="font-size:0.8em;">'+val['address']+'</p><h7>'+ val['workHour'] +'</h7></div><div class="col-3"><button class="btn btn-success" onclick="'+directLink+'">Go!</button></div></div>';              
            });
            $('#modal2').html(html);
          });             
          
        });  
      });
      $("#link5").on("click", function(){
        $.getJSON("./json/taman.json",function(json) {
          var minId;
          var minLat = 99999999;
          var minLon = 99999999;
          var minImageLink;
          var minName;
          var minAddress;
          var minAltText;
          var minQuerry;
          var minMyLat;
          var minMyLon;
          var minDesc;
          var minWorkHour;

          json.forEach(function (val) {
            if (Math.sqrt(((minLat * minLat) + (minLon * minLon)) > (Math.sqrt(((Math.abs(val["lat"]-currLat))*(Math.abs(val["lat"]-currLat))) + ((Math.abs(val["lon"]-currLng))*(Math.abs(val["lon"]-currLng))))))) {
              minLat = (Math.abs(val["lat"]-currLat));
              minLon = (Math.abs(val["lon"]-currLng));
              minId = val["id"];
              minImageLink = val["imageLink"];
              minName = val["name"];
              minAddress = val["address"];
              minAltText = val["altText"];
              minQuerry = val["searchQuerry"];
              minMyLat = val["lat"];
              minMyLon = val["lon"];
              minWorkHour = val["workHour"];
              minDesc = val["desc"];
            }
          });

          $('#map').show();
          $('#mapHeader').show();
          $('#directButton').show();
          $('#tamanImg').attr('src',minImageLink);
          $('#tamanImg').attr('alt',minAltText);
          var judul = '#exampleModalLongTitle1';
          $(judul).html(minName);              
          $('#tamanHeader').html(minName);              
          var keterangan = "Alamat : " + minAddress + "<br>Jam Buka : " + minWorkHour;
          $('#tamanKeterangan').html(keterangan);
          $('#tamanDeskripsi').html(minDesc);
          myLatLong = {lat: minMyLat, lng: minMyLon};
          map = new google.maps.Map(document.getElementById('map'), {
            zoom: 18,
            center: myLatLong
          });
          marker = new google.maps.Marker({
            map: map,
            position: myLatLong,
            title: 'Hello World!'
          });
          myLatLolong = myLatLong;
          myLatLolong.lat+=0.001;
          myLatLolong.lng-=0.0014;
          map.setCenter(myLatLolong);
          google.maps.event.addListenerOnce(map, 'idle', function() {
            google.maps.event.trigger(map, 'resize');
          });
          map.setCenter(myLatLolong);
          var directLink = "";
          directLink = "window.open('https://www.google.com/maps/dir/?api=1&origin=" + currLat + "," + currLng + "&destination=" + minQuerry+"', '_blank');";

          $("#directButton").attr("onclick",directLink); 
        });
      });
    </script>
    <script>
    function initMap() {
      var myLatLng = {lat: -25.363, lng: 131.044};

      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 4,
        center: myLatLng
      });

      var marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        title: 'Hello World!'
      });
    }
    
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAY27kn9izD2u0en0K0SRsX1S32LWMC2_4&callback=initMap">
    </script>
    <script src="./js/fuzzyset.js"></script>
</body></html>
